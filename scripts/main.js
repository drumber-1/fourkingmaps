
var words =['abortion', 'addict', 'adult', 'alabamahotpocket', 'alaskanpipeline', 'amateur', 'anal', 'andromedabitches', 'anilingus', 'anus', 'areola', 'aroused', 'arse', 'arsebadger', 'arsebastard', 'arsebutter', 'arseclown', 'arsegoblin', 'arsehole', 'arsepiece', 'arsewipe', 'assblaster', 'assclown', 'assgas', 'asshole', 'asspirate', 'autoerotic', 'babybatter', 'babygravy', 'backalley', 'backdoorman', 'balderdash', 'balls', 'bampot', 'bang', 'bangbus', 'banging', 'bareback', 'barf', 'barfface', 'bastard', 'batfastard', 'bawbag', 'bazongas', 'bazooms', 'bbw', 'bdsm', 'beastiality', 'beatyourmeat', 'beaver', 'beefcurtains', 'bellend', 'berk', 'bicurious', 'bimbos', 'bint', 'bitch', 'bitchtits', 'blimey', 'bloody', 'blowjob', 'bluewaffle', 'blumpkin', 'bog', 'bollockface', 'bollocks', 'bondage', 'boner', 'bong', 'boning', 'bonk', 'boobs', 'booty', 'bootycall', 'bountybar', 'bra', 'breasts', 'brojob', 'brothel', 'bugger', 'bukkake', 'bullshit', 'bum', 'bunghole', 'busty', 'buswanker', 'butt', 'buttbang', 'buttburp', 'buttchecks', 'butthole', 'buttmuncher', 'buttplug', 'buttstain', 'cack', 'cameltoe', 'camgirl', 'camslut', 'camwhore', 'carpetmuncher', 'choad', 'chonker', 'chungus', 'circlejerk', 'clevelandsteamer', 'clitoris', 'clunge', 'clusterfuck', 'cock', 'cockburger', 'cockmuncher', 'cocknose', 'cocksucker', 'cockwomble', 'coitus', 'colon', 'condom', 'copulate', 'corblimey', 'cornhole', 'cougar', 'covfefe', 'cowpat', 'crabs', 'crackpipe', 'crackwhore', 'crap', 'creampie', 'crotch', 'crotchmonkey', 'crotchrot', 'cuck', 'cuckold', 'cum', 'cumbubble', 'cumdumpster', 'cumfest', 'cumguzzler', 'cumrag', 'cumshot', 'cumwipe', 'cunillingus', 'cunt', 'cuntflaps', 'cuntgrunt', 'cunthead', 'cuntlicker', 'cuntpuddle', 'cyberfucker', 'cybersex', 'cyberslimer', 'daftcow', 'damn', 'damnit', 'dangleberry', 'deepthroat', 'diarrhea', 'dick', 'dickbutt', 'dickcheese', 'dickforbrains', 'dickfucker', 'dickhead', 'dickless', 'dickwad', 'dickweasel', 'dickweed', 'diddle', 'dildo', 'dilf', 'dingleberry', 'dingus', 'dipshit', 'dirtysanchez', 'dobber', 'docking', 'dogging', 'dogshit', 'dolt', 'dominatrix', 'dong', 'doodoo', 'dope', 'douchecanoe', 'douchnozzle', 'drug', 'drunk', 'drunken', 'dryhump', 'dumbfuck', 'dummkopf', 'dunce', 'dutchoven', 'eejit', 'ejaculate', 'enema', 'erection', 'erotic', 'escort', 'excrement', 'explosivediarrhea', 'facefuck', 'faeces', 'fanny', 'fannybaws', 'fannyflaps', 'fart', 'farticle', 'fartlozenge', 'fatass', 'fatso', 'fecal', 'feces', 'feck', 'fecker', 'felch', 'fellatio', 'femdom', 'fetish', 'fiddlesticks', 'fingering', 'fisting', 'fitbin', 'flange', 'flasher', 'flatulence', 'fleshlight', 'floater', 'fondle', 'footjob', 'foreskin', 'fornicate', 'frontbutt', 'frotting', 'fubar', 'fuck', 'fuckbucket', 'fuckbuttons', 'fuckface', 'fucknugget', 'fuckoff', 'fuckshitter', 'fuckstick', 'fucktard', 'fucktrumpet', 'fuckwhit', 'fuckwit', 'fud', 'futanari', 'g-spot', 'gangbang', 'gaping', 'geezer', 'genitals', 'giantcock', 'gimboid', 'ginger', 'git', 'goatse', 'gobshite', 'goldenshower', 'gonorrehea', 'gooch', 'gormless', 'gross', 'grot', 'gspot', 'handjob', 'hardcore', 'hardon', 'harem', 'headfuck', 'hell', 'hentai', 'herpes', 'hitler', 'hoebag', 'hoes', 'holestuffer', 'honkers', 'hooker', 'horndog', 'horny', 'horseshit', 'hump', 'humping', 'hymen', 'idiot', 'imbecile', 'incest', 'intercourse', 'jackass', 'jackoff', 'jebend', 'jeez', 'jerk', 'jerkoff', 'jizz', 'jizzbreath', 'jizzcock', 'jizzmuffin', 'jizzstain', 'jobbernowl', 'jobbie', 'jomblies', 'jugs', 'kinkster', 'kinky', 'knave', 'knob', 'knobber', 'knobcheese', 'knobend', 'knobhead', 'knobjockey', 'knockers', 'ky', 'labia', 'lactate', 'lapdance', 'lazysod', 'lemonparty', 'lesbian', 'limpdick', 'lotion', 'lovejuice', 'lovepump', 'lube', 'magnumdong', 'malaka', 'manpaste', 'manslut', 'manwhore', 'masochist', 'masturbate', 'meatbeater', 'menageatrois', 'milf', 'minge', 'mingebag', 'minger', 'mofo', 'moneyshot', 'mook', 'moron', 'motherfucker', 'muffdiver', 'munter', 'muppet', 'naff', 'nastyslut', 'nastywhore', 'necrophilia', 'nincompoop', 'ninny', 'ninnyhammer', 'nipple', 'nonce', 'noob', 'nudity', 'numbnuts', 'numbskull', 'numpty', 'nutsack', 'nutter', 'nymphomaniac', 'oneguyonejar', 'oral', 'orgasm', 'orgy', 'pansy', 'panties', 'pearlnecklace', 'pecker', 'peckerhead', 'pee', 'peehole', 'peepee', 'peepshow', 'pegging', 'penetration', 'penis', 'penisfucker', 'period', 'phallus', 'piersmorgan', 'pigfucker', 'pillock', 'pimp', 'pimpslap', 'pinhead', 'pish', 'piss', 'pissartist', 'pisser', 'pissflaps', 'pisskidney', 'pisspig', 'pisswizard', 'plonker', 'plumsaucemerchant', 'polesmoker', 'poon', 'poontang', 'poop', 'poopchute', 'pooperscooper', 'pooping', 'porksword', 'porn', 'poxy', 'prat', 'princealbert', 'pubes', 'pussbucket', 'pussy', 'pussyfucker', 'pussylicker', 'pussylover', 'pussypounder', 'queef', 'quim', 'ragingboner', 'randy', 'rapscallion', 'ratarsed', 'rearentry', 'rectum', 'ribbed', 'rimjob', 'rimming', 'rubberjohnny', 'rustytrombone', 'sadist', 'santorum', 'scallywag', 'scat', 'schlong', 'scissoring', 'screenpeaker', 'screwing', 'scrote', 'scrotum', 'scum', 'scunner', 'semen', 'sexdoll', 'sexhound', 'sexkitten', 'sexwhore', 'sexymoma', 'shaft', 'shag', 'shagadelic', 'shazbot', 'shit', 'shitastrophy', 'shitcunt', 'shitdick', 'shitfaced', 'shitforbrains', 'shitfuck', 'shithead', 'shithole', 'shithouse', 'shitlicker', 'shitloaf', 'shitmagnet', 'shitnubbin', 'shitpouch', 'shitspitter', 'shitstain', 'sillysausage', 'sixtynine', 'skank', 'skankybitch', 'skankywhore', 'skinflute', 'slag', 'slapper', 'sleezebag', 'slimeball', 'slut', 'smeghead', 'smegma', 'smut', 'snatch', 'snowballing', 'sodomise', 'soggybiscuit', 'spankthemonkey', 'spawncamper', 'sperm', 'spermherder', 'spitroast', 'splooge', 'spreadeagle', 'spunk', 'spunktrumpet', 'squirting', 'stiffy', 'strapon', 'stripclub', 'stroking', 'stupid', 'stupidfuck', 'suckmyass', 'suckmydick', 'suckmytit', 'swallow', 'swine', 'syphilis', 'tadger', 'tampon', 'tart', 'teabagging', 'teat', 'testicle', 'thestinkbug', 'threesome', 'threeway', 'throatpie', 'thundercunt', 'titbitnipply', 'tits', 'titwank', 'todger', 'tongethruster', 'tonguethrust', 'tosser', 'tosspot', 'tramp', 'tribadism', 'trollop', 'trousersnake', 'tubgirl', 'turd', 'twat', 'twatface', 'twatwaffle', 'twogirlsonecup', 'upskirt', 'urethra', 'urine', 'vagina', 'viagra', 'vibrator', 'vile', 'vulva', 'walloper', 'wally', 'wang', 'wanker', 'wankface', 'wankstain', 'wazzock', 'weeb', 'wetdream', 'whelp', 'whiskydick', 'whore', 'whorefucker', 'whorehouse', 'williewanker', 'willy', 'wizardsleeve', 'wrinkledstarfish', 'wtf'];

var coolmap = L.map('coolmap').setView([51.505, -0.09], 13);

var tileUrl = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
L.tileLayer(tileUrl, {
    maxZoom: 19,
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
    tileSize: 256,
    zoomOffset: 0
}).addTo(coolmap);

// Geolocation
var geoLocationCircle = L.circle([0,0], {radius: 0, color: "green", fillColor: "#0f3", fillOpacity: 0.1});
coolmap.locate({setView: true, mazZoom: 13})

function onLocationFound(e)
{
    geoLocationCircle.remove();
    geoLocationCircle.setRadius(e.accuracy);
    geoLocationCircle.setLatLng(e.latlng);
    geoLocationCircle.addTo(coolmap);

    clickHere(e.latlng);
}

function onLocationError(e)
{
    alert(e.message);
}

coolmap.on("locationfound", onLocationFound)
coolmap.on('locationerror', onLocationError);

var grid = new Grid(L.latLngBounds(L.latLng(49.41, -10.97), L.latLng(61.29, 2.25)), L.point(235647, 440825));
var num_words = 568; // Size of 4-d word grid, this^4 needs to be larger than grid size, word list must have at least this many words
var random_factor = 62327453281; // Needs to be coprime with num_words^4, small numbers will create less apparent randomness
var inverse_random_factor = 103870082465; // Extended Euclidean algorithm calculates this from num_words and random_factor, used to undo the shuffle

var wordGen = new WordGenerator(grid, num_words, random_factor, inverse_random_factor)

var clickHighlightArea = L.rectangle([[0, 0], [0, 0]]);

function onMapClickEvent(e)
{
    clickHere(e.latlng)
}

function clickHere(latLng)
{
    clickHighlightArea.remove();
    var cellBounds = grid.calcCellBounds(latLng);
    clickHighlightArea.setBounds(cellBounds);
    clickHighlightArea.addTo(coolmap);

    var message = "<p class=\"lead\">Area not mapped :(</p>";
    if (grid.bounds.contains(latLng))
    {
        message = "<p class=\"lead\">" + wordGen.generateCoordString(latLng) + "</p>";
    }
    clickHighlightArea.bindPopup(message, {maxWidth : 800}).openPopup();
}

function gotoWords(word0, word1, word2, word3)
{
    var latLng = wordGen.getLatLng(word0, word1, word2, word3);
    if (latLng == null)
        return false;
    coolmap.panTo(latLng);
    clickHere(latLng);
    return true;
}

function resetSearchBarError()
{
    document.getElementById("searchMain").style.background="";
}

function triggerSearchBarError()
{
    document.getElementById("searchMain").style.background="LightPink";
    window.setTimeout(resetSearchBarError, 800);
}

function search(searchTerm)
{
    var success = false;
    if (searchTerm)
    {
        var searchTerms = searchTerm.toLowerCase().split(".");
        if (searchTerms.length == 4)
            success = gotoWords(searchTerms[0], searchTerms[1], searchTerms[2], searchTerms[3]);
        else if (searchTerms.length == 1)
            success = gotoWords(searchTerms[0], searchTerms[0], searchTerms[0], searchTerms[0]);
    }
    return success;
}

function onSearchEvent()
{
    resetSearchBarError();
    var searchValue = document.getElementById("searchMain").value;
    var success = search(searchValue);
    
    if (!success)
        triggerSearchBarError();
}

$(function()
{
    $('.form-control').keypress(function(e)
    {
        if(e.which == 13)
        {
            onSearchEvent();
        }
    })
})

coolmap.on('click', onMapClickEvent);

// Check if we have a position in the url and try and go there
let params = new URLSearchParams(window.location.search)
let input = params.get("fkm")
search(input);
